"use strict";var RS=function(n){this.input=null;this.inputDisplay=null;this.slider=null;this.sliderWidth=0;this.sliderLeft=0;this.pointerWidth=0;this.pointerR=null;this.pointerL=null;this.activePointer=null;this.selected=null;this.scale=null;this.step=0;this.tipL=null;this.tipR=null;this.timeout=null;this.valRange=!1;this.values={start:null,end:null};this.conf={target:null,values:null,set:null,range:!1,width:null,scale:!0,labels:!0,tooltip:!0,step:null,disabled:!1,onChange:null};this.cls={container:"rs-container",background:"rs-bg",selected:"rs-selected",pointer:"rs-pointer",scale:"rs-scale",noscale:"rs-noscale",tip:"rs-tooltip"};for(var t in this.conf)n.hasOwnProperty(t)&&(this.conf[t]=n[t]);this.init()};RS.prototype.init=function(){return(this.input=typeof this.conf.target=="object"?this.conf.target:document.getElementById(this.conf.target.replace("#","")),!this.input)?"":(this.inputDisplay=getComputedStyle(this.input,null).display,this.input.style.display="none",this.valRange=!(this.conf.values instanceof Array),this.valRange&&(!this.conf.values.hasOwnProperty("min")||!this.conf.values.hasOwnProperty("max")))?console.log("Missing min or max value..."):this.createSlider()};RS.prototype.createSlider=function(){return this.slider=createElement("div",this.cls.container),this.slider.innerHTML='<div class="rs-bg"><\/div>',this.selected=createElement("div",this.cls.selected),this.pointerL=createElement("div",this.cls.pointer,["dir","left"]),this.scale=createElement("div",this.cls.scale),this.conf.tooltip&&(this.tipL=createElement("div",this.cls.tip),this.tipR=createElement("div",this.cls.tip),this.pointerL.appendChild(this.tipL)),this.slider.appendChild(this.selected),this.slider.appendChild(this.scale),this.slider.appendChild(this.pointerL),this.conf.range&&(this.pointerR=createElement("div",this.cls.pointer,["dir","right"]),this.conf.tooltip&&this.pointerR.appendChild(this.tipR),this.slider.appendChild(this.pointerR)),this.input.parentNode.insertBefore(this.slider,this.input.nextSibling),this.conf.width&&(this.slider.style.width=parseInt(this.conf.width)+"px"),this.sliderLeft=this.slider.getBoundingClientRect().left,this.sliderWidth=this.slider.clientWidth,this.pointerWidth=this.pointerL.clientWidth,this.conf.scale||this.slider.classList.add(this.cls.noscale),this.setInitialValues()};RS.prototype.setInitialValues=function(){if(this.disabled(this.conf.disabled),this.valRange&&(this.conf.values=prepareArrayValues(this.conf)),this.values.start=0,this.values.end=this.conf.range?this.conf.values.length-1:0,this.conf.set&&this.conf.set.length&&checkInitial(this.conf)){var n=this.conf.set;this.conf.range?(this.values.start=this.conf.values.indexOf(n[0]),this.values.end=this.conf.set[1]?this.conf.values.indexOf(n[1]):null):this.values.end=this.conf.values.indexOf(n[0])}return this.createScale()};RS.prototype.createScale=function(){var n,i,r,t;for(this.step=this.sliderWidth/(this.conf.values.length-1),n=0,i=this.conf.values.length;n<i;n++)r=createElement("span"),t=createElement("ins"),r.appendChild(t),this.scale.appendChild(r),r.style.width=n===i-1?0:this.step+"px",this.conf.labels?t.innerHTML=this.conf.values[n]:(n===0||n===i-1)&&(t.innerHTML=this.conf.values[n]),t.style.marginLeft=t.clientWidth/-2+"px";return this.addEvents()};RS.prototype.updateScale=function(){var t,n,i;for(this.step=this.sliderWidth/(this.conf.values.length-1),t=this.slider.querySelectorAll("span"),n=0,i=t.length;n<i;n++)t[n].style.width=this.step+"px";return this.setValues()};RS.prototype.addEvents=function(){var i=this.slider.querySelectorAll("."+this.cls.pointer),r=this.slider.querySelectorAll("span"),n,t;for(createEvents(document,"mousemove touchmove",this.move.bind(this)),createEvents(document,"mouseup touchend touchcancel",this.drop.bind(this)),n=0,t=i.length;n<t;n++)createEvents(i[n],"mousedown touchstart",this.drag.bind(this));for(n=0,t=r.length;n<t;n++)createEvents(r[n],"click",this.onClickPiece.bind(this));return window.addEventListener("resize",this.onResize.bind(this)),this.setValues()};RS.prototype.drag=function(n){if(n.preventDefault(),!this.conf.disabled){var t=n.target.getAttribute("data-dir");return t==="left"&&(this.activePointer=this.pointerL),t==="right"&&(this.activePointer=this.pointerR),this.slider.classList.add("sliding")}};RS.prototype.move=function(n){if(this.activePointer&&!this.conf.disabled){var i=n.type==="touchmove"?n.touches[0].clientX:n.pageX,t=i-this.sliderLeft-this.pointerWidth/2;return t=Math.round(t/this.step),t<=0&&(t=0),t>this.conf.values.length-1&&(t=this.conf.values.length-1),this.conf.range?(this.activePointer===this.pointerL&&(this.values.start=t),this.activePointer===this.pointerR&&(this.values.end=t)):this.values.end=t,this.setValues()}};RS.prototype.drop=function(){this.activePointer=null};RS.prototype.setValues=function(n,t){var i=this.conf.range?"start":"end";return n&&this.conf.values.indexOf(n)>-1&&(this.values[i]=this.conf.values.indexOf(n)),t&&this.conf.values.indexOf(t)>-1&&(this.values.end=this.conf.values.indexOf(t)),this.conf.range&&this.values.start>this.values.end&&(this.values.start=this.values.end),this.pointerL.style.left=this.values[i]*this.step-this.pointerWidth/2+"px",this.conf.range?(this.conf.tooltip&&(this.tipL.innerHTML=this.conf.values[this.values.start],this.tipR.innerHTML=this.conf.values[this.values.end]),this.input.value=this.conf.values[this.values.start]+","+this.conf.values[this.values.end],this.pointerR.style.left=this.values.end*this.step-this.pointerWidth/2+"px"):(this.conf.tooltip&&(this.tipL.innerHTML=this.conf.values[this.values.end]),this.input.value=this.conf.values[this.values.end]),this.values.end>this.conf.values.length-1&&(this.values.end=this.conf.values.length-1),this.values.start<0&&(this.values.start=0),this.selected.style.width=(this.values.end-this.values.start)*this.step+"px",this.selected.style.left=this.values.start*this.step+"px",this.onChange()};RS.prototype.onClickPiece=function(n){if(!this.conf.disabled){var t=Math.round((n.clientX-this.sliderLeft)/this.step);return t>this.conf.values.length-1&&(t=this.conf.values.length-1),t<0&&(t=0),this.conf.range?t-this.values.start<=this.values.end-t?this.values.start=t:this.values.end=t:this.values.end=t,this.slider.classList.remove("sliding"),this.setValues()}};RS.prototype.onChange=function(){var n=this;this.timeout&&clearTimeout(this.timeout);this.timeout=setTimeout(function(){if(n.conf.onChange&&typeof n.conf.onChange=="function")return n.conf.onChange(n.input.value)},500)};RS.prototype.onResize=function(){return this.sliderLeft=this.slider.getBoundingClientRect().left,this.sliderWidth=this.slider.clientWidth,this.updateScale()};RS.prototype.disabled=function(n){this.conf.disabled=n;this.slider.classList[n?"add":"remove"]("disabled")};RS.prototype.getValue=function(){return this.input.value};RS.prototype.destroy=function(){this.input.style.display=this.inputDisplay;this.slider.remove()};var createElement=function(n,t,i){var r=document.createElement(n);return t&&(r.className=t),i&&i.length===2&&r.setAttribute("data-"+i[0],i[1]),r},createEvents=function(n,t,i){for(var u=t.split(" "),r=0,f=u.length;r<f;r++)n.addEventListener(u[r],i)},prepareArrayValues=function(n){var t=[],u=n.values.max-n.values.min,i,r;if(!n.step)return console.log("No step defined..."),[n.values.min,n.values.max];for(i=0,r=u/n.step;i<r;i++)t.push(n.values.min+i*n.step);return t.indexOf(n.values.max)<0&&t.push(n.values.max),t},checkInitial=function(n){return!n.set||n.set.length<1?null:n.values.indexOf(n.set[0])<0?null:n.range&&(n.set.length<2||n.values.indexOf(n.set[1])<0)?null:!0};window.rSlider=RS;